{extend name="layout/base"}
{block name="main"}
<!--左栏-->
<div class="left">
    <ul class="cl">
        <!--顶级分类-->
        <li v-for="vo,index in menu" :class="{hidden:vo.hidden}">
            <a href="javascript:;" :class="{active:vo.active}" @click="onActive(index)">
                <i class="layui-icon" v-html="vo.icon"></i>
                <span v-text="vo.name"></span>
                <i class="layui-icon arrow" v-show="vo.url.length==0">&#xe61a;</i> <i v-show="vo.active"
                                                                                      class="layui-icon active">&#xe623;</i>
            </a>
            <!--子级分类-->
            <div v-for="vo2,index2 in vo.list">
                <a href="javascript:;" :class="{active:vo2.active}" @click="onActive(index,index2)"
                   v-text="vo2.name"></a>
                <i v-show="vo2.active" class="layui-icon active">&#xe623;</i>
            </div>
        </li>
    </ul>
</div>
<!--右侧-->
<div class="right">
    <fieldset class="layui-elem-field layui-field-title">
        <legend>修改用户</legend>
    </fieldset>


    <form class="layui-form ">
        <div class="layui-form-item">
            <label class="layui-form-label">用户名</label>
            <div class="layui-input-block">
                <input disabled value="{$admin.username}" type="text" name="username" required lay-verify="required" placeholder="" autocomplete="off"
                       class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">密码</label>
            <div class="layui-input-block">
                <input type="password" name="password" required lay-verify="required" placeholder="" autocomplete="off"
                       class="layui-input">
            </div>
        </div>


        <div class="layui-form-item">
            <label class="layui-form-label">是否禁用</label>
            <div class="layui-input-block">
                <input type="checkbox" value="0" name="status" lay-text="开启|关闭" lay-skin="switch" {if $admin.status eq 0}checked{/if}>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">超级管理员权限</label>
            <div class="layui-input-block">
                <input type="checkbox" value="1" name="super" lay-text="开启|关闭" lay-skin="switch" {if $admin.super eq 1}checked{/if}>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-input-block">
                <button class="layui-btn" lay-submit lay-filter="submit">立即修改</button>
            </div>
        </div>
        <input type="hidden" name="_method" value="PUT" >
    </form>

</div>
{/block}
{block name="script"}
<script>
    layui.use('form', function () {
        var form = layui.form,
            layer = layui.layer,
            $ = layui.jquery;
        form.on('submit(submit)', function (data) {
            $.post('/admin/user/{$admin.id}', data.field, function (res) {

                if (res.code === 1) {
                    layer.msg(res.msg, {icon: 5, time: 1500}, () => {
                        layer.load({
                            shade: 0.5,
                            time: 0,
                        });
                        location.href = res.url
                    })
                } else {
                    layer.msg(res.msg, {icon: 6, anim: 2, time: 1500}, () => {
                        // location.reload()
                    })
                }
            })
            return false;
        });
    });
</script>
{/block}
